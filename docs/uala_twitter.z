{"type":"doc","content":[{"type":"schema_heading"},{"type":"paragraph","content":[{"type":"text","text":"[ CHAR ] = {a, ... , z} ∪ {A, ..., Z} ∪ {0, ... , 9}"}]},{"type":"paragraph"},{"type":"schema_heading","content":[{"type":"text","text":"Id"}]},{"type":"schema_roof"},{"type":"schema_top","content":[{"type":"paragraph","content":[{"type":"text","text":"X: ℕ"}]}]},{"type":"paragraph"},{"type":"schema_heading","content":[{"type":"text","text":"Timestamp"}]},{"type":"schema_roof"},{"type":"schema_bottom","content":[{"type":"paragraph","content":[{"type":"text","text":"X: ℕ"}]}]},{"type":"paragraph"},{"type":"schema_heading","content":[{"type":"text","text":"User"}]},{"type":"schema_roof"},{"type":"schema_top","content":[{"type":"paragraph","content":[{"type":"text","text":"ID: Id"}]},{"type":"paragraph","content":[{"type":"text","text":"Name: N ⊆ CHAR"}]},{"type":"paragraph","content":[{"type":"text","text":"Password: P ⊆ CHAR"}]}]},{"type":"schema_bottom","content":[{"type":"paragraph","content":[{"type":"text","text":"|Name| > 0"}]}]},{"type":"paragraph"},{"type":"paragraph","content":[{"type":"text","text":"[ USER_ID ] = Id / Id ∈ { User }"}]},{"type":"paragraph"},{"type":"schema_heading","content":[{"type":"text","text":"Tweet"}]},{"type":"schema_roof"},{"type":"schema_top","content":[{"type":"paragraph","content":[{"type":"text","text":"ID: Id"}]},{"type":"paragraph","content":[{"type":"text","text":"Text: CHAR"}]},{"type":"paragraph","content":[{"type":"text","text":"AuthorId: Id / Id ∈ USER_ID"}]},{"type":"paragraph","content":[{"type":"text","text":"At: Timestamp"}]}]},{"type":"schema_bottom","content":[{"type":"paragraph","content":[{"type":"text","text":"|Text| > 0"}]},{"type":"paragraph","content":[{"type":"text","text":"|Text| ≤ 280"}]}]},{"type":"paragraph"},{"type":"schema_heading","content":[{"type":"text","text":"UserFollows"}]},{"type":"schema_roof"},{"type":"schema_bottom","content":[{"type":"paragraph","content":[{"type":"text","text":"From: Id / Id ∈ USER_ID"}]},{"type":"paragraph","content":[{"type":"text","text":"To: F ⊆ USER_ID"}]}]},{"type":"paragraph"},{"type":"schema_heading","content":[{"type":"text","text":"UserTimelineCache"}]},{"type":"schema_roof"},{"type":"schema_top","content":[{"type":"paragraph","content":[{"type":"text","text":"From: Id / Id ∈ USER_ID"}]},{"type":"paragraph","content":[{"type":"text","text":"Tweets: Tweet"}]}]},{"type":"schema_bottom","content":[{"type":"paragraph","content":[{"type":"text","text":"|Tweets| ≤ 5"}]},{"type":"paragraph","content":[{"type":"text","text":"Tweets ⊆ Tweet / Tweet.AuthorId = From"}]}]},{"type":"paragraph"},{"type":"paragraph","content":[{"type":"text","text":"stdOut == error | accepted"}]},{"type":"paragraph"},{"type":"schema_heading","content":[{"type":"text","text":"Register"}]},{"type":"schema_roof"},{"type":"schema_top","content":[{"type":"paragraph","content":[{"type":"text","text":"Δ User"}]},{"type":"paragraph","content":[{"type":"text","text":"name?: N ⊆ CHAR"}]},{"type":"paragraph","content":[{"type":"text","text":"password?: P ⊆ CHAR"}]},{"type":"paragraph","content":[{"type":"text","text":"out!: stdOut "}]}]},{"type":"schema_bottom","content":[{"type":"paragraph","content":[{"type":"text","text":"name? ∈ dom(user) ⇒ out! = error"}]},{"type":"paragraph","content":[{"type":"text","text":"User' = User ∪ {"}]},{"type":"paragraph","content":[{"type":"text","text":"                {ID: Id / Id.X = max(USER_ID) + 1, name, password }"}]},{"type":"paragraph","content":[{"type":"text","text":"             }"}]},{"type":"paragraph","content":[{"type":"text","text":"             ⇒ out! = accepted"}]}]},{"type":"paragraph"},{"type":"schema_heading","content":[{"type":"text","text":"NewTweet"}]},{"type":"schema_roof"},{"type":"schema_top","content":[{"type":"paragraph","content":[{"type":"text","text":"Δ Tweet"}]},{"type":"paragraph","content":[{"type":"text","text":"authorId?: Id"}]},{"type":"paragraph","content":[{"type":"text","text":"authorPassword?: K ⊆ CHAR"}]},{"type":"paragraph","content":[{"type":"text","text":"text?: T ⊆ CHAR"}]},{"type":"paragraph","content":[{"type":"text","text":"out!: stdOut "}]}]},{"type":"schema_bottom","content":[{"type":"paragraph","content":[{"type":"text","text":"{authorId, authorPassword} ∉ User ⇒ out! = error"}]},{"type":"paragraph","content":[{"type":"text","text":"newTweet = {ID: Id / Id.X = max(TWEET_ID) + 1, text, authorId?,  At: now()}"}]},{"type":"paragraph","content":[{"type":"text","text":"Tweet' = Tweet ∪ { newTweet }"}]},{"type":"paragraph","content":[{"type":"text","text":"UserTimelineCache' = UserTimelineCache ∪ { newTweet }"}]},{"type":"paragraph","content":[{"type":"text","text":"| UserTimelineCache' | ≤ 5 ⇒ out! = accepted"}]},{"type":"paragraph","content":[{"type":"text","text":"UserTimelineCache' = UserTimelineCache - B / B =                                                                             min(UserTimelineCache.At)"}]},{"type":"paragraph","content":[{"type":"text","text":"               ⇒ out! = accepted"}]}]},{"type":"paragraph"}]}